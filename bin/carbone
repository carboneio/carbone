#!/usr/bin/env node

var server = require('../lib/server');
var webserver = require('../lib/webserver');
var translator = require('../lib/translator');
var tool = require('../lib/tool');
var _action = process.argv[2];

switch (_action) {
  case 'server':
    server(process.argv.slice(3));
    break;
  case 'translate':
    translator.handleCLI(process.argv.slice(3));
    break;
  case 'find':
    tool.findMarkers(process.argv.slice(3));
    break;
  case 'webserver':
    webserver.handleParams(process.argv.slice(3));
    break;
  case 'generate-token':
    webserver.generateToken((err, token) => {
      if (err) {
        console.log(err.toString());
        process.exit();
      }

      console.log('Here is a JWT token, valid for 40 years. Place this token in the header like this:');
      console.log('  - Authorization : Bearer your_token\n');
      console.log(token);
      console.log('\n');
      process.exit();
    });
    break;
  default:
    usage();
}

function usage () {
  console.log('*************************************');
  console.log('Carbone usage:');
  console.log('   carbone server [--help]');
  console.log('   carbone translate [--help]');
  console.log('   carbone find [--help]');
  console.log('   carbone webserver [--help]');
  console.log('   carbone generate-token');
  process.exit();
}
